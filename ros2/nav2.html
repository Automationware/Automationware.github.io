<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nav2 &mdash; Automationware 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=86f27845" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
        <script src="../_static/jquery.js?v=8dae8fb0"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8d563738"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Moveit2" href="moveit2.html" />
    <link rel="prev" title="Starting with ROS on the Simulation" href="simulation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo-2b.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ROS2</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="starting_with_ROS.html">Starting with ROS on the Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html">Starting with ROS on the Simulation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Nav2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mapping">Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-map">Creating map</a></li>
<li class="toctree-l4"><a class="reference internal" href="#saving-map">Saving map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#autonomous-navigation">Autonomous Navigation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#localize-the-robot">Localize the robot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sending-goal-s-for-the-robot">Sending goal(s) for the robot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#more-about-navigation-launch">More about Navigation launch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#docking">Docking</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#change-parameters-and-algorithms">Change parameters and algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changing-behaviors">Changing Behaviors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="moveit2.html">Moveit2</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Automationware</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">ROS2</a></li>
      <li class="breadcrumb-item active">Nav2</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/ros2/nav2.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nav2">
<span id="id1"></span><h1>Nav2<a class="headerlink" href="#nav2" title="Link to this heading"></a></h1>
<p>Nav2 is the navigation stack for mobile robots designed for ROS 2. This package is considered both in research and as well as in industrial applications because of the modularity and the wide range of algorithms that it provides to the user. Nav2 is still considered as an evolving project and new features can be expected every fortnight.</p>
<p>In this tutorial, we just explain on how Nav2 is used in our robots. We encourage the users to check out the detailed <a class="reference external" href="https://navigation.ros.org/">official Nav2 documentation page</a> for understanding the concepts surronding it.</p>
<section id="mapping">
<h2>Mapping<a class="headerlink" href="#mapping" title="Link to this heading"></a></h2>
<p>Map is one of the essential component representing the environment based on which the planning algorithm will be able to plan the path for the robot.</p>
<p>For creating a map, we use the <a class="reference external" href="https://github.com/SteveMacenski/slam_toolbox">slam_toolbox</a>.</p>
<section id="creating-map">
<h3>Creating map<a class="headerlink" href="#creating-map" title="Link to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depending on the requirement, the mapping parameters can be changed under <code class="docutils literal notranslate"><span class="pre">~/your_workspace/src/neo_mp(?)_(?)00/config/navigation/mapping.yaml</span></code></p>
</div>
<ul class="simple">
<li><p>Start creating the map, use the following command</p></li>
</ul>
<p>Without namespace:</p>
<p>For MP series robots:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ros2 launch neo_m(?)_(?)00 mapping.launch.py parameters:=~/$your_workspace/src/neo_m(?)_(?)00/configs/navigation/mapping.yaml
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not close the launch until saving the map.</p>
</div>
<ul class="simple">
<li><p>After starting the mapping, in the RViz, the initial stripes of the maps can be found as shown in the image below:</p></li>
</ul>
<figure class="align-default">
<img alt="ros2/neo_mapping_tutorial_1.png" src="ros2/neo_mapping_tutorial_1.png" />
</figure>
<ul class="simple">
<li><p>Navigate the robot around the environment, in order to further build the map.</p></li>
<li><p>Here is an example of a completely built map in our simulation:</p></li>
</ul>
<figure class="align-default">
<img alt="ros2/neo_map_complete.png" src="ros2/neo_map_complete.png" />
</figure>
</section>
<section id="saving-map">
<h3>Saving map<a class="headerlink" href="#saving-map" title="Link to this heading"></a></h3>
<p>To save the map, use the following command</p>
<p>For MP series robots:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ros2 run nav2_map_server map_saver_cli -f ~/to_your_workspace/src/neo_m(?)_(?)00/configs/navigation/maps/your_map_name
</pre></div>
</div>
<dl class="simple">
<dt>In the map folder, two essential files are created</dt><dd><ol class="arabic simple">
<li><p>your_map_name.pgm</p></li>
<li><p>your_map_name.yaml</p></li>
</ol>
</dd>
</dl>
<p>Once the files are created, it’s always essential to rebuild the package, in order for the maps to be installed and available during the run time. If not built, ROS will not be able to find the newly created map.</p>
</section>
</section>
<section id="autonomous-navigation">
<h2>Autonomous Navigation<a class="headerlink" href="#autonomous-navigation" title="Link to this heading"></a></h2>
<p>In order for the robot to autonomously navigate, we require three important components:</p>
<blockquote>
<div><ul class="simple">
<li><p>Localization</p></li>
<li><p>Planning</p></li>
<li><p>Control</p></li>
</ul>
</div></blockquote>
<p>We have a single launch file and a single config file that brings up all the above necessary components.</p>
<p>Before starting the navigation, it is essential to utilize the newly created map for navigation. For this there are 2 ways to go about.</p>
<ol class="arabic simple">
<li><p>A default map for the robots’ environment can be set. For this,</p></li>
</ol>
<p>In case of MP robots, please go to <cite>~/to_your_workspace/src/neo_m(?)_(?)00/launch/navigation.launch.py</cite> and change the default value under the <cite>map_dir</cite> variable.</p>
<p>Once done, the navigation can be initiated from the commandline by running:</p>
<p>Without namespacing:</p>
<p>For MP series robots:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ros2 launch neo_m(?)_(?)00 navigation.launch.py
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Also the map can be chosen from the commandline terminal:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ros2 launch neo_m(?)_(?)00 navigation.launch.py map:=to_your_map_file.yaml
</pre></div>
</div>
<p>Launch RViz</p>
<p>Without namespacing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">launch</span> <span class="n">neo_nav2_bringup</span> <span class="n">rviz_launch</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<section id="localize-the-robot">
<h3>Localize the robot<a class="headerlink" href="#localize-the-robot" title="Link to this heading"></a></h3>
<p>By default we use neo_localization for localization. In order to localize the robot press the “2D Pose Estimate” button and select the robot location on the map.</p>
</section>
<section id="sending-goal-s-for-the-robot">
<h3>Sending goal(s) for the robot<a class="headerlink" href="#sending-goal-s-for-the-robot" title="Link to this heading"></a></h3>
<p>In order the robot to start navigating autonomous a goal position needs to be defined. Assuming the goal position is given, Nav2 uses the planner to find an optimal path for the robot to the goal location. A controller is deployed by Nav2 for the robot to follow the path.</p>
<p>There are different ways to give the goals for the robot, here we will just explain some of them to get started:</p>
<section id="sending-a-single-goal">
<h4>Sending a single goal<a class="headerlink" href="#sending-a-single-goal" title="Link to this heading"></a></h4>
<p>In order to send just a single goal, press the “Nav2 goal” button and select the desired goal location on the map, as shown in the GIF below:</p>
<figure class="align-default">
<img alt="ros2/send_single.gif" src="ros2/send_single.gif" />
</figure>
</section>
<section id="sending-multiple-goals">
<h4>Sending multiple goals<a class="headerlink" href="#sending-multiple-goals" title="Link to this heading"></a></h4>
<p>For the people who are interested in sending multiple goals to the robot, No problem! Navigation2 provides a waypoint-following plugin, which would allow us to select multiple goals. For the ease of the user, we have already configured this plugin and ready for use.</p>
<p>In order to select the multiple goals. First, press the “Waypoint / Nav Through Poses Mode” button.  The again as same as selecting a single goal, press the “Nav2 goal” button to select your goal location.</p>
<p>Note that, before selecting each goal, it is required to press the “Nav2 goal” button.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Waypoint follower plug-in is a direct replacement for the neo_goal_sequence driver, which our ROS-1 users are familiar with.</p>
</div>
<figure class="align-default">
<img alt="ros2/send_multiple.gif" src="ros2/send_multiple.gif" />
</figure>
</section>
</section>
</section>
<section id="more-about-navigation-launch">
<h2>More about Navigation launch<a class="headerlink" href="#more-about-navigation-launch" title="Link to this heading"></a></h2>
<p>Navigation launch is equipped with bunch of arguments, allowing the users to enable multi robot navigation, changing parameter set and enable docking for autonomous charging.</p>
<p>The argument list are as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Arguments</p></th>
<th class="head"><p>Defaults</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>use_multi_robots</cite></p></td>
<td><p><cite>False</cite> (Format: <cite>Bool</cite>)</p></td>
<td><p>Enables namespacing to the nodes related to Nav2</p></td>
</tr>
<tr class="row-odd"><td><p><cite>head_robot</cite></p></td>
<td><p><cite>False</cite> (Format: <cite>Bool</cite>)</p></td>
<td><p>Enables the map server</p></td>
</tr>
<tr class="row-even"><td><p><cite>enable_docking</cite></p></td>
<td><p><cite>False</cite> (Format: <cite>Bool</cite>)</p></td>
<td><p>Enables docking and sets the corresponding nav2 parameters</p></td>
</tr>
<tr class="row-odd"><td><p><cite>use_amcl</cite></p></td>
<td><p><cite>False</cite> (Format: <cite>Bool</cite>)</p></td>
<td><p>Enabled if user wants to use amcl for localization</p></td>
</tr>
<tr class="row-even"><td><p><cite>autostart</cite></p></td>
<td><p><cite>True</cite> (Format: <cite>Bool</cite>)</p></td>
<td><p>Disabled if user wants to trigger the lifecycle nodes</p></td>
</tr>
<tr class="row-odd"><td><p><cite>namespace</cite></p></td>
<td><p>“” (Format: <cite>String</cite>)</p></td>
<td><p>Used in multi-robot scenario</p></td>
</tr>
<tr class="row-even"><td><p><cite>param_file_name</cite></p></td>
<td><p>“navigation.yaml” (Format: <cite>String</cite>)</p></td>
<td><p>Path to the Nav2 param file for each robots</p></td>
</tr>
<tr class="row-odd"><td><p><cite>docking_param_file_name</cite></p></td>
<td><p>“docking_navigation.yaml” (Format: <cite>String</cite>)</p></td>
<td><p>Path to the Nav2 param file for each robots during docking</p></td>
</tr>
<tr class="row-even"><td><p><cite>map</cite></p></td>
<td><p>“test.yaml” (Format: <cite>String</cite>)</p></td>
<td><p>Path to the map file that robot uses for navigation</p></td>
</tr>
</tbody>
</table>
<section id="docking">
<h3>Docking<a class="headerlink" href="#docking" title="Link to this heading"></a></h3>
<p>More information on the docking can be found <a class="reference external" href="https://github.com/neobotix/neo_docking2">here</a>.</p>
</section>
</section>
<section id="change-parameters-and-algorithms">
<h2>Change parameters and algorithms<a class="headerlink" href="#change-parameters-and-algorithms" title="Link to this heading"></a></h2>
<p>There are different algorithms and corresponding parameters as part of the Navigation2 stack. These parameters can be found under <code class="docutils literal notranslate"><span class="pre">~/your_workspace/src/neo_mp(?)_(?)00/config/navigation/navigation.yaml</span></code></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameters</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Options</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Planner</p></td>
<td><p>NavFn</p></td>
<td><p>SMAC Planner</p></td>
</tr>
<tr class="row-odd"><td><p>Controller</p></td>
<td><p>neo_local_planner</p></td>
<td><p>TEB, DWB local planner, MPPIC, etc..</p></td>
</tr>
<tr class="row-even"><td><p>Localization</p></td>
<td><p>neo_localizaiton</p></td>
<td><p>AMCL</p></td>
</tr>
</tbody>
</table>
<p>All the home-brewed algorithms are explained in the section packages. More information about the options specified in the above table can be found in this <a class="reference external" href="https://navigation.ros.org/plugins/">navigation plugins page</a>.</p>
</section>
<section id="changing-behaviors">
<h2>Changing Behaviors<a class="headerlink" href="#changing-behaviors" title="Link to this heading"></a></h2>
<p>Behavior tree is one of the key core concepts that have been adapted into the Navigation 2 stack. Behavior trees in the Nav2 stack provides the user to easily develop and customize various behaviors that the robot should exhibit. Each behaviors are developed as an individual component and then is integrated into the behavior tree. Thus the behavior tree, provides us with a flexible development environment for solving a particular problem at hand.</p>
<p>By default, all the robot packages carry behavior trees, that is customizable according to the application needs. The behavior trees can be found under <code class="docutils literal notranslate"><span class="pre">~/your_workspace/src/neo_mp(?)_(?)00/config/navigation/behavior_trees</span></code> for MP robots and to <code class="docutils literal notranslate"><span class="pre">~/your_workspace/src/rox/rox_navigation/config/behavior_trees</span></code> for ROX.</p>
<p><code class="docutils literal notranslate"><span class="pre">navigating_to_a_pose</span></code> behavior tree is for all the tasks that requires the robot to navigate in free space from point A to point B. Whereas <code class="docutils literal notranslate"><span class="pre">navigate_through_pose</span></code> behavior tree is for the tasks that requires to robot to navigate through set of intermediary hard pose constraints in order to reach the goal localtion</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>More information on behavior trees can be <a class="reference external" href="https://navigation.ros.org/concepts/index.html#behavior-trees">found here</a>. <a class="reference external" href="https://navigation.ros.org/behavior_trees/index.html">Examples of behavior_trees can be found here</a>.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="simulation.html" class="btn btn-neutral float-left" title="Starting with ROS on the Simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="moveit2.html" class="btn btn-neutral float-right" title="Moveit2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Automationware.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>